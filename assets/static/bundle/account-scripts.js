function adjustCurrentCustomerResponse(e){var t=1;_.each(e.data.addresses,(function(e){e.id=t,t++})),e.data.isContact="Contact"===e.data.memberType}(storefrontApp=angular.module("storefrontApp")).service("dialogService",["$uibModal",function(e){return{showDialog:function showDialog(t,n,r){return e.open({controller:n,templateUrl:r,resolve:{dialogData:function dialogData(){return t}}})}}}]),storefrontApp.service("mailingService",["$http","apiBaseUrl",function(e,t){return{sendProduct:function sendProduct(n,r){return e.post(t+"api/b2b/send/product/"+n,r)}}}]),storefrontApp.service("feedbackService",["$http",function(e){return{postFeedback:function postFeedback(t){return e.post("storefrontapi/feedback",{model:t})}}}]),storefrontApp.service("marketingService",["$http",function(e){return{getDynamicContent:function getDynamicContent(t){return e.get("storefrontapi/marketing/dynamiccontent/"+t+"?t="+(new Date).getTime())}}}]),storefrontApp.service("pricingService",["$http",function(e){return{getActualProductPrices:function getActualProductPrices(t){return e.post("storefrontapi/pricing/actualprices",t)}}}]),storefrontApp.service("catalogService",["$http",function(e){return{getProduct:function getProduct(t){return e.get("storefrontapi/products?productIds="+t+"&t="+(new Date).getTime())},getProducts:function getProducts(t){return e.get("storefrontapi/products?"+t+"&t="+(new Date).getTime())},search:function search(t){return e.post("storefrontapi/catalog/search",t)},searchCategories:function searchCategories(t){return e.post("storefrontapi/categories/search",t)}}}]),storefrontApp.service("cartService",["$http",function(e){return{getCart:function getCart(){return e.get("storefrontapi/cart?t="+(new Date).getTime())},getCartItemsCount:function getCartItemsCount(){return e.get("storefrontapi/cart/itemscount?t="+(new Date).getTime())},addLineItem:function addLineItem(t,n){return e.post("storefrontapi/cart/items",{id:t,quantity:n})},changeLineItemQuantity:function changeLineItemQuantity(t,n){return e.put("storefrontapi/cart/items",{lineItemId:t,quantity:n})},changeLineItemsQuantity:function changeLineItemsQuantity(t){return e.put("storefrontapi/cart/items",t)},changeLineItemsQuantityBulk:function changeLineItemsQuantityBulk(t){return e.put("storefrontapi/cart/items/bulk",t)},removeLineItem:function removeLineItem(t){return e.delete("storefrontapi/cart/items?lineItemId="+t)},changeLineItemPrice:function changeLineItemPrice(t,n){return e.put("storefrontapi/cart/items/price",{lineItemId:t,newPrice:n})},clearCart:function clearCart(){return e.post("storefrontapi/cart/clear")},addCoupon:function addCoupon(t){return e.post("storefrontapi/cart/coupons/"+t)},removeCoupon:function removeCoupon(){return e.delete("storefrontapi/cart/coupons")},addOrUpdateShipment:function addOrUpdateShipment(t){return e.post("storefrontapi/cart/shipments",t)},addOrUpdatePayment:function addOrUpdatePayment(t){return e.post("storefrontapi/cart/payments",t)},getAvailableShippingMethods:function getAvailableShippingMethods(t){return e.get("storefrontapi/cart/shipments/"+t+"/shippingmethods?t="+(new Date).getTime())},getAvailablePaymentMethods:function getAvailablePaymentMethods(){return e.get("storefrontapi/cart/paymentmethods?t="+(new Date).getTime())},addOrUpdatePaymentPlan:function addOrUpdatePaymentPlan(t){return e.post("storefrontapi/cart/paymentPlan",t)},removePaymentPlan:function removePaymentPlan(){return e.delete("storefrontapi/cart/paymentPlan")},updatePurchaseOrderNumber:function updatePurchaseOrderNumber(t){return e.put("storefrontapi/cart/purchaseOrderNumber",{purchaseOrderNumber:t})},createOrder:function createOrder(t){return e.post("storefrontapi/cart/createorder",{bankCardInfo:t})}}}]),storefrontApp.service("quoteRequestService",["$http",function(e){return{getCurrentQuoteRequest:function getCurrentQuoteRequest(){return e.get("storefrontapi/quoterequest/current?t="+(new Date).getTime())},getQuoteRequest:function getQuoteRequest(t){return e.get("storefrontapi/quoterequests/"+t+"?t="+(new Date).getTime())},getQuoteRequestItemsCount:function getQuoteRequestItemsCount(t){return e.get("storefrontapi/quoterequests/"+t+"/itemscount?t="+(new Date).getTime())},addProductToQuoteRequest:function addProductToQuoteRequest(t,n){return e.post("storefrontapi/quoterequests/current/items",{productId:t,quantity:n})},removeProductFromQuoteRequest:function removeProductFromQuoteRequest(t,n){return e.delete("storefrontapi/quoterequests/"+t+"/items/"+n)},submitQuoteRequest:function submitQuoteRequest(t,n){return e.post("storefrontapi/quoterequests/"+t+"/submit",{quoteForm:n})},rejectQuoteRequest:function rejectQuoteRequest(t){return e.post("storefrontapi/quoterequests/"+t+"/reject")},updateQuoteRequest:function updateQuoteRequest(t,n){return e.put("storefrontapi/quoterequests/"+t+"/update",{quoteRequest:n})},getTotals:function getTotals(t,n){return e.post("storefrontapi/quoterequests/"+t+"/totals",{quoteRequest:n})},confirmQuoteRequest:function confirmQuoteRequest(t,n){return e.post("storefrontapi/quoterequests/"+t+"/confirm",{quoteRequest:n})}}}]),storefrontApp.service("recommendationService",["$http",function(e){return{getRecommendedProducts:function getRecommendedProducts(t){return e.post("storefrontapi/recommendations",t)}}}]),storefrontApp.service("orderService",["$http",function(e){return{getOrder:function getOrder(t){return e.get("storefrontapi/orders/"+t+"?t="+(new Date).getTime())},processOrderPayment:function processOrderPayment(t,n,r){return e.post("storefrontapi/orders/"+t+"/payments/"+n+"/process",{bankCardInfo:r})},addOrUpdatePayment:function addOrUpdatePayment(t,n){return e.post("storefrontapi/orders/"+t+"/payments",n)}}}]),storefrontApp.service("compareProductService",["$http","$localStorage",function(e,t){return{isInProductCompareList:function isInProductCompareList(e){return!!_.some(t.productCompareListIds,(function(t){return t===e}))},addProduct:function addProduct(e){t.productCompareListIds||(t.productCompareListIds=[]),t.productCompareListIds.push(e),_.uniq(t.productCompareListIds)},getProductsIds:function getProductsIds(){if(t.productCompareListIds){var e=[];for(i=0;i<t.productCompareListIds.length;i++)e.push("productIds="+t.productCompareListIds[i]);return e.join("&")}t.productCompareListIds=[]},getProductsCount:function getProductsCount(){return t.productCompareListIds?t.productCompareListIds.length:0},clearCompareList:function clearCompareList(){t.productCompareListIds=[]},removeProduct:function removeProduct(e){t.productCompareListIds=_.without(t.productCompareListIds,e)}}}]),storefrontApp.service("commonService",["$http",function(e){return{getCountries:function getCountries(){return e.get("storefrontapi/countries?t="+(new Date).getTime())},getCountryRegions:function getCountryRegions(t){return e.get("storefrontapi/countries/"+t+"/regions?t="+(new Date).getTime())}}}]),storefrontApp.service("customerService",["$http",function(e){return{getCurrentCustomer:function getCurrentCustomer(){return e.get("storefrontapi/account?t="+(new Date).getTime())}}}]),(storefrontApp=angular.module("storefrontApp")).controller("mainController",["$rootScope","$scope","$location","$window","accountApi","storefrontApp.mainContext","loadingIndicatorService",function(e,t,n,r,o,i,s){this.loader=s,t.baseUrl={},e.$on("$locationChangeSuccess",(function(){var e=n.path();e&&(t.currentPath=e.replace("/",""))})),e.$on("storefrontError",(function(t,n){e.storefrontNotification=n,e.storefrontNotification.detailsVisible=!1})),e.$on("successOperation",(function(t,n){e.storefrontNotification=n,e.storefrontNotification.detailsVisible=!0})),e.toggleNotificationDetails=function(){e.storefrontNotification.detailsVisible=!e.storefrontNotification.detailsVisible},e.closeNotification=function(){e.storefrontNotification=null},t.outerRedirect=function(e){r.location.href=e},t.innerRedirect=function(e){n.path(e),t.currentPath=n.$$path.replace("/","")},t.stringifyAddress=function(e){var t=e.firstName+" "+e.lastName+", ";return t+=e.organization?e.organization+", ":"",t+=e.countryName+", ",t+=e.regionName?e.regionName+", ":"",t+=e.city+" ",t+=e.line1+", ",t+=e.line2?e.line2:"",t+=e.postalCode},t.getObjectSize=function(e){var t,n=0;for(t in e)e.hasOwnProperty(t)&&n++;return n},t.customer=i.customer,i.loadCustomer=t.loadCustomer=function(){return s.wrapLoading((function(){return o.getCurrentUser().then((function(e){return adjustCurrentCustomerResponse(e),i.customer=t.customer=e.data,e.data}))}))}}]),(storefrontApp=angular.module("storefrontApp")).controller("cartController",["$rootScope","$scope","$timeout","cartService","catalogService","availabilityService","loadingIndicatorService",function(e,t,n,r,o,i,s){var a;t.loader=s,t.coupon={};var u=t.reloadCart=function(){s.wrapLoading((function(){return r.getCart().then((function(e){var n=e.data;n.hasValidationErrors=_.some(n.validationErrors)||_.some(n.items,(function(e){return _.some(e.validationErrors)})),t.cart=n;var r=n.coupon||t.coupon;return r.loader=t.coupon.loader,t.coupon=r,t.coupon.code&&!t.coupon.appliedSuccessfully&&(t.coupon.errorCode="InvalidCouponCode"),i.getProductsAvailability(_.pluck(n.items,"productId")).then((function(e){t.availability=_.object(_.pluck(e.data,"productId"),e.data)}))}))}))};!function initialize(){u()}(),t.setCartForm=function(e){t.formCart=e},t.changeLineItemQuantity=function(o,i){var s=_.find(t.cart.items,(function(e){return e.id==o}));if(!(!s||i<1||t.cartIsUpdating||t.loader.isLoading||t.formCart.$invalid)){var c=s.quantity;s.quantity=i,n.cancel(a),a=n((function(){t.cartIsUpdating=!0,r.changeLineItemQuantity(o,i).then((function(t){u(),e.$broadcast("cartItemsChanged")}),(function(e){s.quantity=c,t.cartIsUpdating=!1}))}),300)}},t.changeLineItemPrice=function(n,o){!_.find(t.cart.items,(function(e){return e.id==n}))||t.cartIsUpdating||t.loader.isLoading||(t.cartIsUpdating=!0,r.changeLineItemPrice(n,o).then((function(t){u(),e.$broadcast("cartItemsChanged")}),(function(e){t.cart.items=initialItems,t.cartIsUpdating=!1})))},t.removeLineItem=function(n){var o=_.find(t.cart.items,(function(e){return e.id==n}));if(o&&!t.cartIsUpdating&&!t.loader.isLoading){t.cartIsUpdating=!0;var i=angular.copy(t.cart.items);t.recentCartItemModalVisible=!1,t.cart.items=_.without(t.cart.items,o),r.removeLineItem(n).then((function(t){u(),e.$broadcast("cartItemsChanged")}),(function(e){t.cart.items=i,t.cartIsUpdating=!1}))}},t.clearCart=function(){s.wrapLoading((function(){return r.clearCart().then((function(){u(),e.$broadcast("cartItemsChanged")}))}))},t.submitCart=function(){t.formCart.$setSubmitted(),t.formCart.$invalid||t.outerRedirect(t.baseUrl+"cart/checkout")},t.searchProduct=function(){t.productSearchResult=null,t.productSkuOrName&&(n.cancel(a),a=n((function(){t.productSearchProcessing=!0;var e={keyword:t.productSkuOrName,start:0,pageSize:5};o.search(e).then((function(e){t.productSearchProcessing=!1,t.productSearchResult=e.data.products}),(function(e){t.productSearchProcessing=!1}))}),300))},t.selectSearchedProduct=function(e){t.productSearchResult=null,t.selectedSearchedProduct=e,t.productSkuOrName=e.name},t.addProductToCart=function(n,o){t.cartIsUpdating=!0,r.addLineItem(n.id,o).then((function(n){u(),t.productSkuOrName=null,t.selectedSearchedProduct=null,e.$broadcast("cartItemsChanged")}))},t.applyCoupon=function(e){e.loader.wrapLoading((function(){return r.addCoupon(e.code).then((function(){u()}))}))},t.removeCoupon=function(e){e.loader.wrapLoading((function(){return r.removeCoupon().then((function(){t.coupon={loader:t.coupon.loader},u()}))}))}}]),storefrontApp.controller("cartBarController",["$scope","cartService",function(e,t){function getCartItemsCount(){t.getCartItemsCount().then((function(t){e.cartItemsCount=t.data}))}getCartItemsCount(),e.$on("cartItemsChanged",(function(e,t){getCartItemsCount()}))}]),(storefrontApp=angular.module("storefrontApp")).controller("quoteRequestController",["$rootScope","$scope","$window","$location","quoteRequestService","commonService",function(e,t,n,r,o,i){function getQuoteRequest(e){o.getQuoteRequest(e).then((function(e){var n=e.data;n.billingAddress||(t.customer.addresses.length?(n.billingAddress=angular.copy(t.customer.addresses[0]),n.billingAddress.type="Billing",n.billingAddress.countryCode&&getCountryRegions("Billing",n.billingAddress.countryCode)):n.billingAddress={firstName:t.customer.firstName,lastName:t.customer.lastName}),_.each(n.items,(function(e){var t=1;_.each(e.proposalPrices,(function(n){n.id=t,e.selectedTierPrice.quantity==n.quantity&&(e.selectedTierPrice=n),t++}))})),n.requestShippingQuote=!0,t.quoteRequest=n}))}function getCountryRegions(e,n){i.getCountryRegions(n).then((function(n){var r=n.data;"Billing"==e&&(t.billingCountryRegions=r||[]),"Shipping"==e&&(t.shippingCountryRegions=r||[])}))}function toFormModel(e){var t={id:e.id,tag:e.tag,status:e.status,comment:e.comment,billingAddress:e.billingAddress,shippingAddress:e.shippingAddress,items:[]};return _.each(e.items,(function(e){var n={id:e.id,comment:e.comment,selectedTierPrice:{price:e.selectedTierPrice.price.amount,quantity:e.selectedTierPrice.quantity},proposalPrices:[]};_.each(e.proposalPrices,(function(e){n.proposalPrices.push({price:e.price.amount,quantity:e.quantity})})),t.items.push(n)})),t}!function initialize(){var e=r.url().replace("/","")||n.currentQuoteRequestNumber;t.billingCountry=null,t.shippingCountry=null,function getCountries(){i.getCountries().then((function(e){t.countries=e.data}))}(),e?getQuoteRequest(e):t.quoteRequest={itemsCount:0}}(),t.setQuoteRequestForm=function(e){t.formQuoteRequest=e},t.displayForStatuses=function(e){return _.contains(e,t.quoteRequest.status)},t.addTierPrice=function(e){e.proposalPrices.push({id:e.proposalPrices.length+1,price:e.salePrice,quantity:1})},t.changeTierPriceQuantity=function(e,t){t<1||t.isNaN||(e.quantity=t)},t.removeTierPrice=function(e,t){e.proposalPrices=_.without(e.proposalPrices,t)},t.removeProductFromQuoteRequest=function(n){var r=angular.copy(t.quoteRequest.items);t.quoteRequest.items=_.without(t.quoteRequest.items,n),o.removeProductFromQuoteRequest(t.quoteRequest.id,n.id).then((function(n){getQuoteRequest(t.quoteRequest.id),e.$broadcast("actualQuoteRequestItemsChanged")}),(function(e){t.quoteRequest.items=r}))},t.setCountry=function(e,n){var r=_.find(t.countries,(function(e){return e.name==n}));r&&("Billing"==e&&(t.billingCountry=r,t.billingCountryRegions=[],t.quoteRequest.billingAddress.countryCode=r.code3||r.code2,t.quoteRequest.billingAddress.regionId=null,t.quoteRequest.billingAddress.regionName=null),"Shipping"==e&&(t.shippingCountry=r,t.shippingCountryRegions=[],t.quoteRequest.shippingAddress.countryCode=r.code3||r.code2,t.quoteRequest.shippingAddress.regionId=null,t.quoteRequest.shippingAddress.regionName=null),r.code3&&getCountryRegions(e,r.code3))},t.setCountryRegion=function(e){if("Billing"==e){if(!(n=_.find(t.billingCountryRegions,(function(e){return e.name==t.quoteRequest.billingAddress.regionName}))))return;t.quoteRequest.billingAddress.regionId=n.code}if("Shipping"==e){var n;if(!(n=_.find(t.shippingCountryRegions,(function(e){return e.name==t.quoteRequest.shippingAddress.regionName}))))return;t.quoteRequest.shippingAddress.regionId=n.code}},t.selectCustomerAddress=function(e){if("Billing"===e){var n=_.find(t.customer.addresses,(function(e){return e.id===t.quoteRequest.billingAddress.id}));n&&(n.type="Billing",n.countryCode&&getCountryRegions("Billing",n.countryCode),t.quoteRequest.billingAddress=angular.copy(n))}if("Shipping"===e){var r=_.find(t.customer.addresses,(function(e){return e.id===t.quoteRequest.shippingAddress.id}));r&&(r.type="Shipping",r.countryCode&&getCountryRegions("Shipping",r.countryCode),t.quoteRequest.shippingAddress=angular.copy(r))}},t.stringifyAddress=function(e){if(e){var t=e.firstName+" "+e.lastName+", ";return t+=e.organization?e.organization+", ":"",t+=e.countryName+", ",t+=e.regionName?e.regionName+", ":"",t+=e.city+" ",t+=e.line1+", ",t+=e.line2?e.line2:"",t+=e.postalCode}},t.submitQuoteRequest=function(){t.formQuoteRequest.$setSubmitted(),t.formQuoteRequest.$invalid||(t.quoteRequest.billingAddress.email=t.quoteRequest.email,t.quoteRequest.shippingAddress&&(t.quoteRequest.shippingAddress.email=t.quoteRequest.email),o.submitQuoteRequest(t.quoteRequest.id,toFormModel(t.quoteRequest)).then((function(e){t.customer.isRegisteredUser?t.outerRedirect(t.baseUrl+"account/quoterequests"):t.outerRedirect(t.baseUrl+"account/login")})))},t.rejectQuoteRequest=function(){o.rejectQuoteRequest(t.quoteRequest.id).then((function(e){o.getQuoteRequest(t.quoteRequest.id).then((function(e){t.quoteRequest=e.data}))}))},t.selectTierPrice=function(){o.getTotals(t.quoteRequest.id,toFormModel(t.quoteRequest)).then((function(e){t.quoteRequest.totals=e.data}))},t.confirmQuoteRequest=function(){o.confirmQuoteRequest(t.quoteRequest.id,toFormModel(t.quoteRequest)).then((function(e){t.outerRedirect(t.baseUrl+"cart/checkout/#/shipping-address")}))},t.setRequestShippingQuote=function(){t.quoteRequest.requestShippingQuote||(t.quoteRequest.shippingAddress=null)},t.setShippingAddressEqualsBilling=function(){t.quoteRequest.shippingAddressEqualsBilling&&(t.quoteRequest.shippingAddress=angular.copy(t.quoteRequest.billingAddress),t.quoteRequest.shippingAddress.type="Shipping",t.quoteRequest.shippingAddress.countryCode&&(t.shippingCountry=t.billingCountry,getCountryRegions("Shipping",t.quoteRequest.shippingAddress.countryCode)))},t.tierPricesUnique=function(e){var t=_.map(e.proposalPrices,(function(e){return e.quantity}));return _.uniq(t).length==e.proposalPrices.length}}]),storefrontApp.controller("actualQuoteRequestBarController",["$scope","quoteRequestService",function(e,t){function getCurrentQuoteRequest(){t.getCurrentQuoteRequest().then((function(t){e.actualQuoteRequest=t.data}))}getCurrentQuoteRequest(),e.$on("actualQuoteRequestItemsChanged",(function(e,t){getCurrentQuoteRequest()}))}]),storefrontApp.controller("recentlyAddedActualQuoteRequestItemDialogController",["$scope","$window","$uibModalInstance","dialogData",function(e,t,n,r){e.$on("actualQuoteRequestItemsChanged",(function(e,t){r.updated=!0})),e.dialogData=r,e.close=function(){n.close()},e.redirect=function(e){t.location=e}}]),(storefrontApp=angular.module("storefrontApp")).component("vcAddress",{templateUrl:"themes/assets/address.tpl.html",bindings:{address:"=",addresses:"<",countries:"=",validationContainer:"=",getCountryRegions:"&",editMode:"<",onUpdate:"&"},require:{checkoutStep:"?^vcCheckoutWizardStep"},transclude:{header:"?addressHeader",footer:"?addressFooter"},controller:["$scope",function(e){var t=this;function setAddressRegion(e,n){e.region=_.findWhere(n,{code:e.regionId}),e.region?(t.address.regionId=t.address.region.code,t.address.regionName=t.address.region.name):(t.address.regionId=void 0,t.address.regionName=void 0)}t.types=[{id:"Billing",name:"Billing"},{id:"Shipping",name:"Shipping"},{id:"BillingAndShipping",name:"Billing and Shipping"}],this.$onInit=function(){t.validationContainer&&t.validationContainer.addComponent(this),t.checkoutStep&&t.checkoutStep.addComponent(this)},this.$onDestroy=function(){t.validationContainer&&t.validationContainer.removeComponent(this),t.checkoutStep&&t.checkoutStep.removeComponent(this)},t.setForm=function(e){t.form=e},t.validate=function(){return!t.form||(t.form.$setSubmitted(),t.form.$valid)},e.$watch("$ctrl.address",(function(){t.address&&(!function populateRegionalDataForAddress(e){e&&(e.country=_.findWhere(t.countries,{code3:e.countryCode}),null!=e.country&&(t.address.countryName=t.address.country.name,t.address.countryCode=t.address.country.code3),e.country&&(e.country.regions?setAddressRegion(e,e.country.regions):t.getCountryRegions({country:e.country}).then((function(t){e.country.regions=t,setAddressRegion(e,t)}))))}(t.address),t.address.name=function stringifyAddress(e){var n="",r=_.find(t.types,(function(e){return e.id==t.address.addressType}));r&&(n="["+r.name+"] ");var o=n;return o+=e.firstName+" "+e.lastName+", ",o+=e.organization?e.organization+", ":"",o+=e.countryName+", ",o+=e.regionName?e.regionName+", ":"",o+=e.city+" ",o+=e.line1+", ",o+=e.line2?e.line2:"",o+e.postalCode}(t.address)),t.onUpdate({address:t.address})}),!0)}]}),(storefrontApp=angular.module("storefrontApp")).component("vcCreditCard",{templateUrl:"themes/assets/js/common-components/creditCard.tpl.html",require:{checkoutStep:"?^vcCheckoutWizardStep"},bindings:{card:"=",validationContainer:"="},controller:["$scope","$filter",function(e,t){var n=this;this.$onInit=function(){n.validationContainer&&n.validationContainer.addComponent(this),n.checkoutStep&&n.checkoutStep.addComponent(this)},this.$onDestroy=function(){n.validationContainer&&n.validationContainer.removeComponent(this),n.checkoutStep&&n.checkoutStep.removeComponent(this)},e.$watch("$ctrl.card.bankCardHolderName",(function(e){n.card&&(n.card.bankCardHolderName=t("uppercase")(e))}),!0),n.validate=function(){return n.form.$setSubmitted(),!n.form.$invalid}}]}),(storefrontApp=angular.module("storefrontApp")).component("vcErrors",{templateUrl:"themes/assets/errors.tpl.html",bindings:{level:"<",message:"<",errors:"<"},controller:[function(){this.level=this.level||"danger"}]}),(storefrontApp=angular.module("storefrontApp")).component("vcItemAvailability",{templateUrl:"themes/assets/js/common-components/item-availability.tpl.html",bindings:{availability:"<"},controller:[function(){}]}),angular.module("storefrontApp").component("vcLabeledInput",{templateUrl:"themes/assets/labeled-input.tpl.html",bindings:{value:"=",form:"=",name:"@",inputClass:"<",placeholder:"@",type:"@?",required:"<",requiredError:"@?",autofocus:"<",pattern:"@",disabled:"<"},controller:[function(){var e=this;e.validate=function(){return e.form.$setSubmitted(),e.form.$valid}}]}),angular.module("storefrontApp").component("vcLabeledSelect",{templateUrl:"themes/assets/labeled-select.tpl.html",require:{ngModel:"?ngModel"},bindings:{options:"<",select:"&",form:"<",name:"@",placeholder:"<",required:"<",requiredError:"@?",autofocus:"<",isOpen:"=?",disabled:"<"},controller:["$scope",function(e){var t=this;t.$onInit=function(){t.required&&t.ngModel.$setValidity("required",!1),t.ngModel.$render=function(){t.value=t.ngModel.$viewValue}},t.validate=function(){return t.form.$setSubmitted(),t.form.$valid};var n=t.select;t.select=function(e){t.value=e,t.required&&t.ngModel.$setValidity("required",!1),t.ngModel.$setViewValue(t.value),n(e)}}]}),angular.module("storefrontApp").component("vcLabeledTextArea",{templateUrl:"themes/assets/labeled-textarea.tpl.html",bindings:{value:"=",form:"=",name:"@",label:"@",required:"<",requiredError:"@?",pattern:"<?",autofocus:"<"},controller:[function(){var e=this;e.validate=function(){return e.form.$setSubmitted(),e.form.$valid}}]}),(storefrontApp=angular.module("storefrontApp")).component("vcLineItems",{templateUrl:"themes/assets/js/common-components/lineItems.tpl.liquid",bindings:{items:"="}}),(storefrontApp=angular.module("storefrontApp")).component("vcMember",{templateUrl:"themes/assets/member.tpl.html",bindings:{member:"=",memberComponent:"="},controller:["$scope",function(e){var t=this;this.$onInit=function(){t.memberComponent=this},this.$onDestroy=function(){t.memberComponent=null},t.setForm=function(e){t.form=e},t.validate=function(){return!t.form||(t.form.$setSubmitted(),t.form.$valid)}}]}),(storefrontApp=angular.module("storefrontApp")).component("vcMemberDetail",{templateUrl:"themes/assets/memberDetail.tpl.html",bindings:{member:"=",memberComponent:"=",fieldsConfig:"<"},controller:["$scope","b2bRoles",function(e,t){var n=this;function getFieldConfig(e){return _.first(_.filter(n.config,(function(t){return t.field===e})))}n.config=[{field:"CompanyName",disabled:!1,visible:!0,required:!0},{field:"Email",disabled:!1,visible:!0,required:!0},{field:"UserName",disabled:!1,visible:!0},{field:"Password",disabled:!1,visible:!0},{field:"Roles",disabled:!1,visible:!1}],n.fieldsConfig&&angular.extend(n.config,n.fieldsConfig),n.availableRoles=t,e.$watch("$ctrl.member",(function(e){e&&e.roles&&(e.role=_.find(n.availableRoles,(function(t){return t.id==e.roles[0].id})))})),n.rolesComponent=null,this.$onInit=function(){n.memberComponent=this},this.$onDestroy=function(){n.memberComponent=null},n.setForm=function(e){n.form=e},n.validate=function(){return!n.form||(n.form.$setSubmitted(),n.form.$valid)},n.showField=function(e){return 1==getFieldConfig(e).visible},n.disableField=function(e){return 1==getFieldConfig(e).disabled},n.requiredField=function(e){return 1==getFieldConfig(e).required}}]}),(storefrontApp=angular.module("storefrontApp")).component("vcPaymentMethods",{templateUrl:"themes/assets/js/common-components/paymentMethods.tpl.html",require:{checkoutStep:"?^vcCheckoutWizardStep"},bindings:{getAvailPaymentMethods:"&",onSelectMethod:"&",paymentMethod:"=",validationContainer:"="},controller:["$scope",function(e){var t=this;this.$onInit=function(){t.getAvailPaymentMethods().then((function(e){t.availPaymentMethods=_.sortBy(e,(function(e){return e.priority})),t.paymentMethod&&(t.paymentMethod=_.findWhere(t.availPaymentMethods,{code:t.paymentMethod.code})),!t.paymentMethod&&t.availPaymentMethods.length>0&&t.selectMethod(t.availPaymentMethods[0])})),t.validationContainer&&t.validationContainer.addComponent(this),t.checkoutStep&&t.checkoutStep.addComponent(this)},this.$onDestroy=function(){t.validationContainer&&t.validationContainer.removeComponent(this),t.checkoutStep&&t.checkoutStep.removeComponent(this)},t.validate=function(){return t.paymentMethod},t.selectMethod=function(e){t.paymentMethod=e,t.onSelectMethod({paymentMethod:e})}}]}),(storefrontApp=angular.module("storefrontApp")).component("vcPaymentPlan",{templateUrl:"themes/assets/js/common-components/paymentPlan.tpl.html",bindings:{availablePaymentPlans:"<"},controller:[function(){this.type="once",this.paymentPlan=this.availablePaymentPlans[0]}]}),(storefrontApp=angular.module("storefrontApp")).component("vcSearchBar",{templateUrl:"themes/assets/js/common-components/searchBar.tpl.html",bindings:{formClass:"<",placeholder:"<",searching:"<",noResults:"<",query:"@",categoriesLabel:"<",productsLabel:"<",submitLabel:"<",categoryLimit:"@",productLimit:"@"},controller:["$scope","$q","catalogService",function(e,t,n){var r=this;r.hasHint=!1,e.$watch("$ctrl.isOpen",(function(e){r.hasHint=!!r.query&&!e})),e.$watch("$ctrl.query",(function(e){r.hasHint=!!e&&!r.isOpen})),r.getSuggestions=function(){var e={keyword:r.query,start:0,isFuzzySearch:!0};return t.all([n.searchCategories(angular.extend({},e,{pageSize:r.categoryLimit})),n.search(angular.extend({},e,{pageSize:r.productLimit}))]).then((function(e){var t=function process(t){return(e[0].data[t]||e[1].data[t]).map((function(e){return e.within=t,e}))};return t("categories").concat(t("products")).map((function(e,t){return e.index=t,e}))}))}}]}),(storefrontApp=angular.module("storefrontApp")).constant("vcTotalsDefaults",{show:{subtotal:!0,taxes:!0,shipping:!0,payment:!0,discount:!0},complete:!1}),storefrontApp.component("vcTotals",{templateUrl:"themes/assets/js/common-components/totals.tpl.liquid",bindings:{order:"<",options:"<"},controller:["vcTotalsDefaults",function(e){this.options=angular.merge({},e,this.options);var t=this.showWithTaxes?"WithTax":"";this.fieldNames={subTotal:"subTotal"+t,shippingPrice:"shippingPrice"+t,shippingTotal:"shippingTotal"+t,payment:"paymentPrice"+t,discount:"discountTotal"+t}}]}),angular.module("storefront.account").component("vcAccountAddresses",{templateUrl:"themes/assets/account-addresses.tpl.liquid",require:{accountManager:"^vcAccountManager"},controller:["storefrontApp.mainContext","confirmService","$translate","$scope","accountApi","loadingIndicatorService",function(e,t,n,r,o,i){var s=this;s.loader=i,s.currentMember=e.customer,r.$watch((function(){return e.customer}),(function(e){s.currentMember=e})),s.addNewAddress=function(){_.last(a).validate()&&(s.currentMember.addresses.push(s.newAddress),s.newAddress=null,s.updateAddresses(s.currentMember))},s.setAsDefault=function(e){s.currentMember.defaultShippingAddress=s.currentMember.contact.defaultShippingAddress=e,s.updateCustomer(s.currentMember)},s.submit=function(){a[s.editIndex].validate()&&(angular.copy(s.editAddress,s.currentMember.addresses[s.editIndex]),s.updateAddresses(s.currentMember,s.cancel))},s.cancel=function(){s.editIndex=-1,s.editAddress=null},s.edit=function(e){s.editIndex=e,s.editAddress=angular.copy(s.currentMember.addresses[s.editIndex])},s.delete=function(e){var r=function showDialog(n){t.confirm(n).then((function(t){t&&(s.currentMember.addresses.splice(e,1),s.updateAddresses(s.currentMember))}))};n("customer.addresses.delete_confirm").then(r,r)},s.updateCustomer=function(t,n){return i.wrapLoading((function(){return t.role&&(t.roles=[t.role.id]),o.updateUser(t).then((function(){return e.loadCustomer().then((function(e){s.currentMember=e,n&&n()}))}))}))},s.updateAddresses=function(t,n){return i.wrapLoading((function(){return o.updateUserAddresses(t.addresses).then((function(){return e.loadCustomer().then((function(e){s.currentMember=e,n&&n()}))}))}))};var a=[];s.addComponent=function(e){a.push(e)},s.removeComponent=function(e){a=_.without(a,e)}}]}),angular.module("storefront.account").component("vcAccountCheckoutDefaults",{templateUrl:"themes/assets/account-checkout-defaults.tpl.liquid",require:{accountManager:"^vcAccountManager"},controller:["storefrontApp.mainContext","$scope","cartService","loadingIndicatorService","checkoutDefaultService","customerService",function(e,t,n,r,o,i){var s=this;s.loader=r,s.defaults=o,s.deliveryMethods=[{type:"shipping"},{type:"pickup"}],s.customer={},s.getAvailPaymentMethods=function(){return n.getAvailablePaymentMethods().then((function(e){return e.data}))},s.getAvailShippingMethods=function(){return n.getAvailableShippingMethods().then((function(e){return e.data}))},s.getAvailPaymentMethods().then((function(e){s.paymentMethods=e})),s.getAvailShippingMethods().then((function(e){s.shippingMethods=e})),i.getCurrentCustomer().then((function(e){s.customer=e.data}))}]}),angular.module("storefront.account").component("vcAccountCompanyInfo",{templateUrl:"themes/assets/account-company-info.tpl.liquid",require:{accountManager:"^vcAccountManager"},controller:["storefrontApp.mainContext","$scope","$translate","accountApi","loadingIndicatorService","confirmService",function(e,t,n,r,o,i){var s=this;function refresh(){o.wrapLoading((function(){return r.getUserOrganization().then((function(e){s.company=e.data}))}))}s.loader=o,s.updateCompanyInfo=function(e){return o.wrapLoading((function(){return r.updateUserOrganization(e).then((function(){refresh()}))}))},s.addNewAddress=function(){_.last(a).validate()&&(s.company.addresses.push(s.newAddress),s.newAddress=null,s.updateCompanyInfo(s.company))},s.submitCompanyAddress=function(){a[s.editIdx].validate()&&(angular.copy(s.editItem,s.company.addresses[s.editIdx]),s.updateCompanyInfo(s.company).then(s.cancel))},s.cancel=function(){s.editIdx=-1,s.editItem=null},s.edit=function(e){s.editIdx=e,s.editItem=angular.copy(s.company.addresses[s.editIdx])},s.delete=function(e){var t=function showDialog(t){i.confirm(t).then((function(t){t&&(s.company.addresses.splice(e,1),s.updateCompanyInfo(s.company))}))};n("customer.addresses.delete_confirm").then(t,t)};var a=[];s.addComponent=function(e){a.push(e)},s.removeComponent=function(e){a=_.without(a,e)},refresh()}]}),angular.module("storefront.account").component("vcAccountCompanyMemberDetail",{templateUrl:"account-company-member-detail.tpl",require:{accountManager:"^vcAccountManager"},controller:["$q","$rootScope","$scope","$window","accountApi","loadingIndicatorService",function(e,t,n,r,o,i){var s=this;function refresh(){i.wrapLoading((function(){return o.getUserById(s.memberNumber).then((function(e){s.member=e.data}))}))}s.loader=i,s.fieldsConfig=[{field:"CompanyName",disabled:!0,visible:!1,required:!1},{field:"Email",disabled:!1,visible:!0,required:!0},{field:"UserName",disabled:!0,visible:!1},{field:"Password",disabled:!0,visible:!1},{field:"Roles",disabled:!1,visible:!0}],s.memberComponent=null,n.init=function(e){s.storeId=e},this.$routerOnActivate=function(e){s.pageNumber=e.params.pageNumber||1,s.memberNumber=e.params.member,refresh()},s.submitMember=function(){s.memberComponent.validate()&&i.wrapLoading((function(){return s.member.fullName=s.member.firstName+" "+s.member.lastName,s.member.emails=[s.member.email],s.member.roles=[s.member.role.name],o.updateUser(s.member).then((function(e){refresh()}))}))}}]}),angular.module("storefront.account").component("vcAccountCompanyMembers",{templateUrl:"themes/assets/account-company-members.tpl.liquid",$routeConfig:[{path:"/",name:"MemberList",component:"vcAccountCompanyMembersList",useAsDefault:!0},{path:"/:member",name:"MemberDetail",component:"vcAccountCompanyMemberDetail"}],controller:["storefrontApp.mainContext",function(e){}]}).component("vcAccountCompanyMembersList",{templateUrl:"account-company-members-list.tpl",bindings:{$router:"<"},controller:["storefrontApp.mainContext","$scope","accountApi","loadingIndicatorService","confirmService","$location","$translate",function(e,t,n,r,o,i,s){var a=this;function refresh(){a.errors=void 0,r.wrapLoading((function(){return n.searchOrganizationUsers({skip:(a.pageSettings.currentPage-1)*a.pageSettings.itemsPerPageCount,take:a.pageSettings.itemsPerPageCount,sortInfos:a.sortInfos}).then((function(e){a.entries=e.data.results,a.pageSettings.totalItems=e.data.totalCount}))}))}a.currentMemberId=e.customer.id,a.newMemberComponent=null,a.loader=r,a.pageSettings={currentPage:1,itemsPerPageCount:5,numPages:10},a.pageSettings.pageChanged=function(){refresh()},a.addNewMemberFieldsConfig=[{field:"CompanyName",disabled:!0,visible:!1,required:!1},{field:"Email",disabled:!1,visible:!0,required:!0},{field:"UserName",disabled:!1,visible:!0,required:!0},{field:"Password",disabled:!1,visible:!0,required:!0},{field:"Roles",disabled:!1,visible:!0,required:!0}],t.init=function(e,t,n){a.storeId=e,a.cultureName=t,a.registrationUrl=n},this.$routerOnActivate=function(e){a.pageSettings.currentPage=e.params.pageNumber||a.pageSettings.currentPage,refresh()},a.inviteEmailsValidationPattern=new RegExp(/((^|((?!^)([,;]|\r|\r\n|\n)))([a-zA-Z0-9.!#$%&’*+/=?^_`{|}~-]+@[a-zA-Z0-9-]+(?:\.[a-zA-Z0-9-]+)*))+$/),a.invite=function(){a.inviteInfo.emails=a.inviteInfo.rawEmails.split(/[,;]|\r|\r\n|\n/g),r.wrapLoading((function(){return n.createInvitation({emails:a.inviteInfo.emails,message:a.inviteInfo.message}).then((function(e){e.data.succeeded?(a.cancel(),refresh()):a.errors=_.pluck(e.data.errors,"description")}))}))},a.addNewMember=function(){a.newMemberComponent.validate()&&(a.newMember.organizationId=e.customer.organizationId,a.newMember.role=a.newMember.role?a.newMember.role.id:void 0,a.newMember.storeId=a.storeId,r.wrapLoading((function(){return n.registerNewUser(a.newMember).then((function(e){e.data.succeeded?(a.cancel(),a.pageSettings.currentPage=1,a.pageSettings.pageChanged()):a.errors=_.pluck(e.data.errors,"description")}))})))},a.cancel=function(){a.inviteInfo=null,a.newMember=null},a.changeStatus=function(e){r.wrapLoading((function(){var t=e.isLockedOut?n.unlockUser:n.lockUser;return e.isLockedOut=!e.isLockedOut,t(e.id).then((function(e){e.data.succeeded?refresh():a.errors=_.pluck(e.data.errors,"description")}))}))},a.edit=function(e){this.$router.navigate(["MemberDetail",{member:e,pageNumber:a.pageSettings.currentPage}])},a.delete=function(e){var t=function showDialog(t){o.confirm(t).then((function(t){t&&r.wrapLoading((function(){return n.deleteUser(e.id).then((function(e){e.data.succeeded?refresh():a.errors=_.pluck(e.data.errors,"description")}))}))}))};s("customer.edit_company_members.delete_confirm").then(t,t)},a.validate=function(){return a.inviteForm.$setSubmitted(),a.inviteForm.valid},a.showActions=function(t){return t.id!=e.customer.id}}]}),angular.module("storefront.account").component("vcAccountLists",{templateUrl:"lists-manager.tpl",$routeConfig:[{path:"/",name:"Lists",component:"vcAccountLists"},{path:"/myLists",name:"MyLists",component:"vcAccountMyLists",useAsDefault:!0}],controller:["listsApi","$rootScope","cartService","$translate","loadingIndicatorService","$timeout",function(e,t,n,r,o,i){var s=this;s.loader=o,s.selectedList={},s.errors=null,s.selectTab=function(e){s.selectedList={},s.selectedTab=e},s.selectList=function(t){s.errors=null,s.selectedList=t,o.wrapLoading((function(){return e.getWishlist(t.name,t.type).then((function(e){s.selectedList.items=e.data.items}))}))},s.removeLineItem=function(t,n){o.wrapLoading((function(){return e.removeLineItem(t.id,n.name,n.type).then((function(e){s.selectList(n)}))}))},s.addToCart=function(e){o.wrapLoading((function(){return n.addLineItem(e.productId,1).then((function(n){e.productAdded=!0,i((function(){e.productAdded=!1}),1e4),t.$broadcast("cartItemsChanged")}))}))}}]}).component("vcAccountMyLists",{templateUrl:"themes/assets/js/account/account-lists.tpl.liquid",require:{accountLists:"^^vcAccountLists"},controller:["$rootScope","listsApi","customerService","loadingIndicatorService","$q","dialogService",function(e,t,n,r,o,i){var s=this;s.type=null,s.predefinedLists=[],s.pageSettings={currentPage:1,itemsPerPageCount:5,numPages:4},s.pageSettings.pageChanged=function(){s._searchLists()},s._searchLists=function(){s.accountLists.errors=null,r.wrapLoading((function(){return t.searchLists({pageNumber:s.pageSettings.currentPage,pageSize:s.pageSettings.itemsPerPageCount,type:s.type}).then((function(e){s.accountLists.lists=e.data.results,s.pageSettings.totalItems=e.data.totalCount,s.accountLists.selectedList=_.first(e.data.results)}))}))},s.initialize=function(e){s.predefinedLists=e.default_lists,s.type=e.default_list_type;var n=[];_.each(s.predefinedLists,(function(e){n.push(function createList(e,n){return t.createList(e,n)}(e.name,e.type))})),o.all(n).then((function(){s._searchLists()}))},s.$onInit=function(){s.accountLists.selectTab("myLists")},s.createList=function(){var e={lists:s.lists,type:s.type};i.showDialog(e,"recentlyCreateNewListDialogController","storefront.lists-create-new-list-dialog.tpl").result.then((function(e){e&&(e.error?s.accountLists.errors=[e.error]:(s.pageSettings.currentPage=1,s._searchLists()))}))},s.addToCartAllProducts=function(n){r.wrapLoading((function(){return t.mergeWithCurrentCart(n,s.type).then((function(t){e.$broadcast("cartItemsChanged")}))}))},s.listSettings=function(){r.wrapLoading((function(){return t.searchLists({pageSize:1e4,type:s.type}).then((function(e){var t={lists:e.data.results,predefinedLists:s.predefinedLists,type:s.type};i.showDialog(t,"recentlyCreateNewListDialogController","storefront.lists-settings-dialog.tpl").result.then((function(e){s.pageSettings.currentPage=1,s._searchLists()}))}))}))}}]}),angular.module("storefront.account").component("vcAccountOrders",{templateUrl:"themes/assets/js/account/account-orders.tpl.liquid",$routeConfig:[{path:"/",name:"OrderList",component:"vcAccountOrdersList",useAsDefault:!0},{path:"/:number",name:"OrderDetail",component:"vcAccountOrderDetail"}],controller:[function(){}]}).component("vcAccountOrdersList",{templateUrl:"account-orders-list.tpl",controller:["accountApi","loadingIndicatorService","$window","sortAscending","sortDescending","orderStatuses",function(e,t,n,r,o,i){var s=this;function loadData(){return t.wrapLoading((function(){return e.searchUserOrders({pageNumber:s.pageSettings.currentPage,pageSize:s.pageSettings.itemsPerPageCount,sort:"".concat(s.sortInfos.sortBy,":").concat(s.sortInfos.sortDirection),statuses:s.selectedStatuses}).then((function(e){s.entries=e.data.results,s.pageSettings.totalItems=e.data.totalCount}))}))}s.sortDescending=o,s.sortAscending=r,s.orderStatuses=i,s.selectedStatuses=[],s.loader=t,s.filterDropdownSettings={template:"{{option}}",smartButtonTextConverter:function smartButtonTextConverter(e,t){return t}},s.dropdownEvents={onSelectionChanged:function filtersChanged(){s.pageSettings.currentPage=1,loadData()}},s.pageSettings={currentPage:1,itemsPerPageCount:10,numPages:10},s.pageSettings.pageChanged=function(){loadData()},s.getInvoicePdf=function(e){var t=n.BASE_URL+"storefrontapi/orders/"+e+"/invoice";n.open(t,"_blank")},s.sortInfos={sortBy:"number",sortDirection:o},s.sortChanged=function(e){s.sortInfos.sortDirection=s.sortInfos.sortBy===e?function invertSortDirection(e){return e==r?o:r}(s.sortInfos.sortDirection):r,s.sortInfos.sortBy=e,loadData()},s.getSortDirection=function(e){return s.sortInfos.sortBy===e?s.sortInfos.sortDirection:""},this.$routerOnActivate=function(e){s.pageSettings.currentPage=e.params.pageNumber||s.pageSettings.currentPage,s.pageSettings.pageChanged()}}]}).component("vcAccountOrderDetail",{templateUrl:"account-order-detail.tpl",require:{accountManager:"^vcAccountManager"},controller:["$rootScope","$window","loadingIndicatorService","confirmService","accountApi","inventoryApi","orderService",function(e,t,n,r,o,i,s){var a=this;function refresh(){n.wrapLoading((function(){return o.getUserOrder(a.orderNumber).then((function(e){return a.order=e.data,a.paymentNumber=a.order.inPayments[0].number,a.order})).then((function(e){var t=_.last(_.sortBy(e.inPayments,"createdDate"));a.billingAddress=t&&t.billingAddress||_.findWhere(e.addresses,{type:"billing"})||_.first(e.addresses),o.getUserOrderNewPaymentData(e.number).then((function(e){a.paymentMethods=e.data.paymentMethods,_.each(a.order.inPayments,(function(e){a.selectedPaymentMethod=_.find(a.paymentMethods,(function(t){return t.code==e.gatewayCode})),a.selectedPaymentMethod&&(e.paymentMethod=a.selectedPaymentMethod,a.selectedPaymentMethodCode=a.selectedPaymentMethod.code)}))})),a.deliveryMethod={type:"shipping"},i.searchFulfillmentCenters({}).then((function(t){a.deliveryMethod.fulfillmentCenter=_.find(t.data.results,(function(t){return t.address.line1==e.shipments[0].deliveryAddress.line1})),a.deliveryMethod.fulfillmentCenter&&(a.deliveryMethod.type="pickup")}))}))}))}a.loader=n,a.hasPhysicalProducts=!0,this.$routerOnActivate=function(e){a.pageNumber=e.params.pageNumber||1,a.orderNumber=e.params.number,refresh()},a.getInvoicePdf=function(){var e=t.BASE_URL+"storefrontapi/orders/"+a.orderNumber+"/invoice";t.open(e,"_blank")},a.paymentMethodChanged=function(){n.wrapLoading((function(){return a.selectedPaymentMethod=_.find(a.paymentMethods,(function(e){return e.code==a.selectedPaymentMethodCode})),a.order.inPayments[0].gatewayCode=a.selectedPaymentMethod.code,a.order.inPayments[0].paymentMethodType=a.selectedPaymentMethod.paymentMethodType,s.addOrUpdatePayment(a.orderNumber,a.order.inPayments[0]).then((function(e){refresh()}))}))},a.payInvoice=function(){a.selectedPaymentMethod.paymentMethodType&&"preparedform"==a.selectedPaymentMethod.paymentMethodType.toLowerCase()?function outerRedirect(e){t.location.href=e}(t.BASE_URL+"cart/checkout/paymentform?orderNumber="+a.orderNumber):n.wrapLoading((function(){return s.processOrderPayment(a.orderNumber,a.paymentNumber,null).then((function(t){var r=t.data.orderProcessingResult;r.isSuccess?(a.order.inPayments[0].status="Paid",e.$broadcast("successOperation",{type:"success",message:"Invoice "+a.orderNumber+" has been successfully paid"}),s.addOrUpdatePayment(a.orderNumber,a.order.inPayments[0]).then((function(e){refresh()}))):function handleBadPaymentResult(t){return n.isLoading=!1,void e.$broadcast("storefrontError",{type:"error",title:["Error in new order processing: ",t.error,"New Payment status: "+t.newPaymentStatus].join(" "),message:t.error})}(r)}))}))};var u=[];a.addComponent=function(e){u.push(e)},a.removeComponent=function(e){u=_.without(u,e)}}]}).filter("orderToSummarizedStatusLabel",[function(){return function(e){return!!e&&(e.status||"New")}}]),angular.module("storefront.account").component("vcAccountPasswordChange",{templateUrl:"themes/assets/js/account/account-password-change.tpl.liquid",require:{accountManager:"^vcAccountManager"},controller:["loadingIndicatorService","accountApi",function(e,t){var n=this;n.loader=e,n.passwordChangeData={},n.submit=function(){n.errors=null,n.error={};var r,o=!1;r=n.passwordChangeData.oldPassword===n.passwordChangeData.newPassword,n.error.newPassword=r,(o=o||r)||(r=n.passwordChangeData.newPassword!==n.passwordChangeData.newPassword2,n.error.newPassword2=r,o=o||r),o||e.wrapLoading((function(){return t.changeUserPassword(n.passwordChangeData).then((function(e){return angular.extend(n,e),n.passwordChangeData={},n.form.$setPristine(),e}))}))},n.setForm=function(e){n.form=e}}]}),angular.module("storefront.account").component("vcAccountProfileUpdate",{templateUrl:"themes/assets/account-profile-update.tpl.liquid",require:{accountManager:"^vcAccountManager"},controller:["$q","$scope","storefrontApp.mainContext","accountApi","loadingIndicatorService","b2bRoles",function(e,t,n,r,o,i){var s=this;s.loader=o,s.availableRoles=i,s.member=n.customer,t.$watch((function(){return n.customer}),(function(e){s.member=e,s.member.roles&&s.member.roles.length&&(s.member.role=_.find(s.availableRoles,(function(e){return e.id==s.member.roles[0].id})))})),s.submit=function(){return s.member.fullName=s.member.firstName+" "+s.member.lastName,s.member.emails=[s.member.email],s.member.role&&(s.member.roles=[s.member.role.id]),o.wrapLoading((function(){return r.updateUser(s.member).then((function(e){return n.loadCustomer().then((function(e){s.member=e}))}))}))}}]}),angular.module("storefront.account").component("vcAccountQuotes",{templateUrl:"themes/assets/js/account/account-quotes.tpl.liquid",require:{accountManager:"^vcAccountManager"},controller:[function(){var e=this;e.pageSettings={currentPage:1,itemsPerPageCount:5,numPages:10},e.pageSettings.pageChanged=function(){e.accountManager.getQuotes(e.pageSettings.currentPage,e.pageSettings.itemsPerPageCount,e.sortInfos,(function(t){e.entries=t.results,e.pageSettings.totalItems=t.totalCount}))},this.$routerOnActivate=function(t){e.pageSettings.currentPage=t.params.pageNumber||e.pageSettings.currentPage,e.pageSettings.pageChanged()}}]}),(storefrontApp=angular.module("storefrontApp")).controller("accountRegisterController",["$q","$scope","storefrontApp.mainContext","loadingIndicatorService","vcRecaptchaService","commonService","WizardHandler","accountApi",function(e,t,n,r,o,i,s,a){function setAddressRegion(e,t){e.region=_.findWhere(t,{code:e.regionId}),e.region?(e.regionId=e.region.code,e.regionName=e.region.name):(e.regionId=void 0,e.regionName=void 0)}t.loader=r,t.finished=!1,i.getCountries().then((function(e){t.countries=e.data})),t.$watch("registration.address",(function(e){e&&function populateRegionalDataForAddress(e){e&&(e.country=_.findWhere(t.countries,{code3:e.countryCode}),e.country&&(e.countryName=e.country.name,e.countryCode=e.country.code3,e.country.regions?setAddressRegion(e,e.country.regions):i.getCountryRegions(e.country.code3).then((function(t){e.country.regions=t.data,setAddressRegion(e,t.data)}))))}(e)}),!0),t.init=function(e){t.registration={storeId:e,type:"Business",address:{},email:null},t.switchTemplate(t.registration.type)},t.finishedWizard=function(){return r.wrapLoading((function(){return a.registerOrganization(t.registration).then((function(e){e.data.succeeded?t.outerRedirect(t.baseUrl):e.data.errors&&(t.errors=_.map(e.data.errors,(function(e){return e.description})))}))}))},t.switchTemplate=function(e){"Business"===e?(t.step1TemplateUrl="step1-business",t.step2TemplateUrl="step2-business"):"Personal"===e&&(t.step1TemplateUrl="step1-personal",t.step2TemplateUrl="step2-personal")}}]),angular.module("storefront.account").component("vcAccountSubscriptions",{templateUrl:"themes/assets/js/account/account-subscriptions.tpl.liquid",$routeConfig:[{path:"/",name:"SubscriptionList",component:"vcAccountSubscriptionsList",useAsDefault:!0},{path:"/:number",name:"SubscriptionDetail",component:"vcAccountSubscriptionDetail"}]}).component("vcAccountSubscriptionsList",{templateUrl:"account-subscriptions-list.tpl",controller:["accountApi","confirmService","loadingIndicatorService","$translate",function(e,t,n,r){var o=this;o.loader=n,o.pageSettings={currentPage:1,itemsPerPageCount:5,numPages:10},o.pageSettings.pageChanged=function(){n.wrapLoading((function(){return e.searchUserSubscriptions({pageNumber:o.pageSettings.currentPage,pageSize:o.pageSettings.itemsPerPageCount,sortInfos:o.sortInfos}).then((function(e){o.entries=e.data.results,o.pageSettings.totalItems=e.data.totalCount}))}))},this.$routerOnActivate=function(e){o.pageSettings.currentPage=e.params.pageNumber||o.pageSettings.currentPage,o.pageSettings.pageChanged()}}]}).component("vcAccountSubscriptionDetail",{templateUrl:"account-subscription-detail.tpl",controller:["accountApi","confirmService","loadingIndicatorService","$translate",function(e,t,n,r){var o=this;function refresh(){n.wrapLoading((function(){return e.getUserSubscription({number:o.entryNumber}).then((function(e){o.subscription=angular.copy(e.data)}))}))}o.loader=n,this.$routerOnActivate=function(e){o.pageNumber=e.params.pageNumber||1,o.entryNumber=e.params.number,refresh()},o.cancel=function(){n.wrapLoading((function(){return e.cancelUserSubscription({number:o.entryNumber,cancelReason:o.cancelReason}).then((function(e){o.subscription=angular.copy(e.data),o.isCancelFormVisible=!1,refresh()}))}))}}]}).filter("toIntervalKey",(function(){return function(e,t){return"customer.subscriptions.intervals."+e.interval.toLowerCase()+"_"+(1===t?1:"plural")}}));var storefrontApp,moduleName="storefront.account";void 0!==storefrontAppDependencies&&storefrontAppDependencies.push(moduleName),angular.module(moduleName,["ngResource","ngComponentRouter","pascalprecht.translate","ngSanitize","storefrontApp","storefrontApp.consts"]).config(["$translateProvider","baseUrl",function(e,t){e.useSanitizeValueStrategy("sanitizeParameters"),e.useUrlLoader(t+"themes/localization.json"),e.preferredLanguage("en")}]).run(["$templateCache",function(e){e.put("pagerTemplate.html",'<ul uib-pagination boundary-links="true" max-size="$ctrl.pageSettings.numPages" items-per-page="$ctrl.pageSettings.itemsPerPageCount" total-items="$ctrl.pageSettings.totalItems" ng-model="$ctrl.pageSettings.currentPage" ng-change="$ctrl.pageSettings.pageChanged()" class="pagination-sm" style="padding-bottom: 20px;" previous-text="&lsaquo;" next-text="&rsaquo;" first-text="&laquo;" last-text="&raquo;"></ul uib-pagination>')}]).value("$routerRootComponent","vcAccountManager").service("accountDialogService",["$uibModal",function(e){return{showDialog:function showDialog(t,n,r){e.open({controller:n,templateUrl:r,resolve:{dialogData:function dialogData(){return t}}})}}}]).component("vcAccountManager",{templateUrl:"account-manager.tpl",bindings:{baseUrl:"<",customer:"<"},$routeConfig:[{path:"/orders/...",name:"Orders",component:"vcAccountOrders"},{path:"/subscriptions/...",name:"Subscriptions",component:"vcAccountSubscriptions"},{path:"/quotes",name:"Quotes",component:"vcAccountQuotes"},{path:"/profile",name:"Profile",component:"vcAccountProfileUpdate",useAsDefault:!0},{path:"/addresses",name:"Addresses",component:"vcAccountAddresses"},{path:"/changePassword",name:"PasswordChange",component:"vcAccountPasswordChange"},{path:"/companyInfo",name:"CompanyInfo",component:"vcAccountCompanyInfo"},{path:"/companyMembers/...",name:"CompanyMembers",component:"vcAccountCompanyMembers"},{path:"/lists/...",name:"Lists",component:"vcAccountLists"},{path:"/checkoutDefaults",name:"CheckoutDefaults",component:"vcAccountCheckoutDefaults"}],controller:["$scope","$timeout","storefrontApp.mainContext","loadingIndicatorService","commonService",function(e,t,n,r,o){var i=this;i.loader=r,i.availCountries=[],r.wrapLoading((function(){return o.getCountries().then((function(e){i.availCountries=e.data}))})),i.getCountryRegions=function(e){return r.wrapLoading((function(){return o.getCountryRegions(e.code3).then((function(e){return e.data}))}))}}]}).service("confirmService",["$q",function(e){this.confirm=function(t){return e.when(window.confirm(t||"Is it OK?"))}}]).service("checkoutDefaultService",["$localStorage",function(e){return{paymentMethod:void 0,shippingMethod:void 0,deliveryMethod:void 0,address:void 0}}]),(storefrontApp=angular.module("storefrontApp")).service("accountApi",["$http",function(e){return{getCurrentUser:function getCurrentUser(){return e.get("storefrontapi/account?t="+(new Date).getTime())},getUserById:function getUserById(t){return e.get("storefrontapi/account/"+t+"?t="+(new Date).getTime())},updateUser:function updateUser(t){return e.post("storefrontapi/account",t)},updateUserAddresses:function updateUserAddresses(t){return e.post("storefrontapi/account/addresses",t)},getUserOrganization:function getUserOrganization(){return e.get("storefrontapi/account/organization/current?t="+(new Date).getTime())},updateUserOrganization:function updateUserOrganization(t){return e.put("storefrontapi/account/organization",t)},registerOrganization:function registerOrganization(t){var n=angular.element('input[name="__RequestVerificationToken"]').attr("value");return e.post("storefrontapi/account/organization",t,{headers:{RequestVerificationToken:n}})},searchOrganizationUsers:function searchOrganizationUsers(t){return e.post("storefrontapi/account/organization/users/search",t)},createInvitation:function createInvitation(t){return e.post("storefrontapi/account/invitation",t)},registerNewUser:function registerNewUser(t){return e.post("storefrontapi/account/user",t)},lockUser:function lockUser(t){return e.post("storefrontapi/account/"+t+"/lock")},unlockUser:function unlockUser(t){return e.post("storefrontapi/account/"+t+"/unlock")},deleteUser:function deleteUser(t){return e.delete("storefrontapi/account/"+t)},searchUserOrders:function searchUserOrders(t){return e.post("storefrontapi/orders/search",t)},getUserOrder:function getUserOrder(t){return e.get("storefrontapi/orders/"+t+"?t="+(new Date).getTime())},getUserOrderNewPaymentData:function getUserOrderNewPaymentData(t){return e.get("storefrontapi/orders/"+t+"/newpaymentdata?t="+(new Date).getTime())},searchUserSubscriptions:function searchUserSubscriptions(t){return e.post("storefrontapi/subscriptions/search",t)},getUserSubscription:function getUserSubscription(t){return e.get("storefrontapi/subscriptions/{number}",searchCriteria)},cancelUserSubscription:function cancelUserSubscription(t){return e.post("storefrontapi/subscriptions/cancel",t)},changeUserPassword:function changeUserPassword(t){return e.post("storefrontapi/account/password",t)}}}]),angular.module("storefrontApp").component("addToListButton",{templateUrl:"themes/assets/js/lists/add-to-list-button.tpl.html",bindings:{selectedVariation:"<"},controller:["accountApi","dialogService","listsApi","customerService",function(e,t,n,r){var o=this;o.$onInit=function(){!function compareProductInLists(){o.buttonInvalid=!0,n.searchLists({pageSize:1e4,type:o.type}).then((function(e){if(o.lists=e.data.results,o.lists){var t=_.pluck(o.lists,"name");n.getListsWithProduct(o.selectedVariation.id,t,o.type).then((function(e){var t=e.data;t&&_.each(o.lists,(function(e){e.contains=_.contains(t,e.name)}))}))}})),r.getCurrentCustomer().then((function(e){o.customer=e.data}))}()},o.addProductToWishlist=function(){var e=function toListsDialogDataModel(e,t){return{product:e,quantity:t,updated:!1}}(o.selectedVariation,1);t.showDialog(e,"recentlyAddedListItemDialogController","storefront.lists-added-list-item-dialog.tpl")},o.signInToProceed=function(){t.showDialog({title:"Add product to list..."},"universalDialogController","storefront.sign-in-to-proceed.tpl")}}]}),(storefrontApp=angular.module("storefrontApp")).controller("recentlyAddedListItemDialogController",["$scope","$window","$uibModalInstance","dialogData","listsApi","$translate","defaultLists","$q","loadingIndicatorService",function(e,t,n,r,o,i,s,a,u){e.availableLists=[],e.selectedList={},e.dialogData=r,e.inProgress=!1,e.itemAdded=!1,e.type=r.listType,e.addProductToList=function(){e.inProgress=!0,o.addLineItem(r.product.id,e.selectedList.name,e.selectedList.type).then((function(t){t.data&&(e.inProgress=!1,e.itemAdded=!0)}))},e.selectList=function(t){e.selectedList=t},e.close=function(){n.close()},e.redirect=function(e){t.location=e},e._searchLists=function(){u.wrapLoading((function(){return o.searchLists({pageSize:1e3,type:e.type}).then((function(t){if(e.lists=t.data.results,e.lists){var n=_.pluck(e.lists,"name");o.getListsWithProduct(r.product.id,n,e.type).then((function(t){var n=t.data;e.lists&&n&&_.each(e.lists,(function(e){e.contains=_.contains(n,e.name)}))}))}}))}))},e.initialize=function(){e.predefinedLists=s.default_lists,e.type=s.default_list_type;var t=[];_.each(e.predefinedLists,(function(e){t.push(function createList(e,t){return o.createList(e,t)}(e.name,e.type))})),a.all(t).then((function(){e._searchLists()}))},e.initialize()}]),(storefrontApp=angular.module("storefrontApp")).controller("recentlyCreateNewListDialogController",["$rootScope","$scope","$window","$uibModalInstance","customerService","dialogData","listsApi","$localStorage","loadingIndicatorService","$translate","confirmService",function(e,t,n,r,o,i,s,a,u,c,d){t.dialogData=i.lists,t.predefinedLists=i.lists,t.userName=i.userName,t.inProgress=!1,t.data=t.listName,t.selectedTab=i.selectedTab,t.type=i.type,t.createList=function(){s.createList(t.dialogData.listName,t.type).then((function(e){r.close(e.data)}))},t.selectedList=function(e,n){var r=s.getWishlist(e,n).items;t.selectedList.items=r},t.isAnySelected=function(){return null!=_.find(i.lists,(function(e){return e.delete}))},t.submitSettings=function(){!function showDialog(e){d.confirm(e).then((function(e){if(e){var t=[];_.each(i.lists,(function(e){e.delete&&t.push(e.id)})),t.length>0&&s.deleteListsByIds(t).then((function(e){r.close()}))}}))}("Are you sure you wish to delete this list?")},t.close=function(){r.dismiss("cancel")},function inititlize(){_.each(t.dialogData,(function(e){_.find(i.predefinedLists,(function(t){return t.name===e.name}))&&(e.disabled=!0)}))}()}]),(storefrontApp=angular.module("storefrontApp")).service("listsApi",["$http",function(e){return{getWishlist:function getWishlist(t,n){return e.get("storefrontapi/lists/"+t+"/"+n+"?t="+(new Date).getTime())},getListsWithProduct:function getListsWithProduct(t,n,r){return e.post("storefrontapi/lists/getlistswithproduct",{productId:t,listNames:n,type:r})},addLineItem:function addLineItem(t,n,r){return e.post("storefrontapi/lists/items",{productId:t,listName:n,type:r})},removeLineItem:function removeLineItem(t,n,r){return e.delete("storefrontapi/lists/"+n+"/"+r+"/items/"+t)},searchLists:function searchLists(t){return e.post("storefrontapi/lists/search",t)},createList:function createList(t,n){return e.post("storefrontapi/lists/"+t+"/"+n+"/create")},deleteListsByIds:function deleteListsByIds(t){return e.delete("storefrontapi/lists/deletelistsbyids?listIds="+t.join("&listIds="))},mergeWithCurrentCart:function mergeWithCurrentCart(t,n){return e.post("storefrontapi/lists/"+t+"/"+n+"/mergewithcurrentcart")}}}]);
//# sourceMappingURL=account-scripts.js.map
